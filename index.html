<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’¡ ë²•ë¥  ìƒì‹ í€´ì¦ˆ ğŸ’¡</title>
<style>
/*... (keep all your existing styles unchanged)... */
</style>
</head>
<body>

<div id="start-screen" class="screen-container active">
<h1>âš–ï¸ ë²•ë¥  ìƒì‹ í€´ì¦ˆ</h1>
<p style="margin-bottom:30px;font-size:1.1em">ë§¤ì¼ ìƒˆë¡œìš´ ë²•ë¥  ìƒì‹ì„ í€´ì¦ˆë¡œ ë°°ì›Œë³´ì„¸ìš”.<br>í•œ ì„¸íŠ¸ë‹¹ 5ë¬¸ì œê°€ ì¶œì œë©ë‹ˆë‹¤.</p>
<button id="newQuizSetBtnEl" class="btn btn-primary">âœ¨ ìƒˆ í€´ì¦ˆ ì„¸íŠ¸ ìƒì„±</button>
<button id="reviewBtnEl" class="btn btn-success" onclick="handleEnterReviewMode()">ğŸ“š ì§€ë‚œ ì˜¤ë‹µ ë³µìŠµí•˜ê¸°</button>
</div>

<div id="quiz-screen" class="screen-container">
<!--... (keep your existing quiz screen code unchanged)... -->
</div>

<div id="result-screen" class="screen-container">
<!--... (keep your existing results screen code unchanged)... -->
</div>

<div id="review-screen" class="screen-container">
<h1>ğŸ“š ì˜¤ë‹µ ë…¸íŠ¸</h1>
<div id="review-list"></div>
<button class="btn btn-secondary" onclick="location.reload()">ğŸ  ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
</div>

<script>
//... (keep your existing quiz logic code unchanged)...

// Fix for review system
let legalReviews = JSON.parse(localStorage.getItem('legalReviews')) || [];

function handleEnterReviewMode() {
    // Get all stored quizzes (including history)
    const storedQuizzes = JSON.parse(localStorage.getItem(STORAGE_KEY_QUIZZES)) || [];
    
    // Combine with existing legalReviews array
    legalReviews = legalReviews.concat(
        storedQuizzes.filter(q => 
          !q.is_correct_answered && 
          !legalReviews.some(r => r.question === q.question)
        )
    );

    // Update local storage with combined reviews
    localStorage.setItem('legalReviews', JSON.stringify(legalReviews));

    // Show review screen
    document.querySelectorAll('.screen-container').forEach(el => el.classList.remove('active'));
    document.getElementById('review-screen').classList.add('active');

    // Populate review list
    const reviewList = document.getElementById('review-list');
    reviewList.innerHTML = '';

    if (legalReviews.length === 0) {
        reviewList.innerHTML = '<p>ì˜¤ë‹µ ë…¸íŠ¸ê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.</p>';
        return;
    }

    legalReviews.forEach((review, idx) => {
        const div = document.createElement('div');
        div.className = 'review-item';
        div.innerHTML = `
            <h3>${idx + 1}. ${review.question}</h3>
            <p style="color:red">ë‚´ ë‹µ: ${review.userAnswer}</p>
            <p style="color:blue">ì •ë‹µ: ${review.correctAnswer}</p>
            <p>í•´ì„¤: ${review.explanation || 'í•´ì„¤ì´ ì œê³µë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.'}</p>
            <p>ì €ì¥ ì‹œê°„: ${new Date(review.timestamp).toLocaleString()}</p>
        `;
        reviewList.appendChild(div);
    });
}

// Event listener for review submission
if (document.getElementById('reviewForm')) {
    document.getElementById('reviewForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const quizzes = document.getElementById('quizzes').value;
        const reviewKey = `review_${Date.now()}`;
        
        const reviewData = {
            quizzes: quizzes,
            timestamp: Date.now()
        };
        
        localStorage.setItem(reviewKey, JSON.stringify(reviewData));
        alert('ë¦¬ë·°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
    });
}
</script>
</body>
</html>
